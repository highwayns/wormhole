# NFTブリッジアプリ

【目次】

## 目的

ワームホールメッセージパッシングプロトコルを使用して、接続された異なるチェーン間でNFTを転送します。

## バックグラウンド

NFTは、最近人気が高まっている新しい資産クラスです。特に新しいユーザーや企業を引き付けます
暗号。 NFTは、従来のトークンと同様に、単一のブロックチェーンで作成され、他のチェーンに転送することはできません。
しかし、より多くのチェーンがNFT標準と市場を導入するにつれて、チェーン間でNFTSを転送する方法が求められています。
これらの市場にアクセスし、単一のウォレットに収集します。

## 目標

あらゆるものをブリッジできるワームホールメッセージパッシングプロトコルを使用して、一般化されたNFTブリッジを実装したいと考えています。
チェーン間の標準準拠のNFT。オンデマンドで接続された各チェーンに一意のラップされた表現を作成します。

*チェーン間で標準に準拠したNFTの転送を許可します。
*ほとんどのVMデータ型と互換性のあるユニバーサルNFT表現を使用します。

## 非目標

* EIP1155をサポート
*すべてのチェーンに広く適用できるわけではないチェーン固有のNFTメタデータを管理/転送します。
* NFT転送メッセージをターゲットチェーンに自動的に中継します。

## 概要

NFTブリッジネットワークの各チェーンには、NFTブリッジエンドポイントプログラムがあります。

これらのプログラムは、ペイロードの承認(エミッターフィルタリング)、外部チェーンのラップされた表現を管理します
NFT(「ラップされたNFT」)および保管ロックされたNFT。

私たちは以下をサポートすることを目指しています:

-EIP721:イーサリアム、BSC
-メタプレックスSPLメタ:ソラナ

## 詳細設計

アウトバウンド転送の場合、コントラクトには、ネイティブNFTをロックアップし、
ワームホールに投稿される、またはラップされたNFTを焼き付けて、そのメッセージを生成/投稿するそれぞれの転送メッセージ。

インバウンド転送の場合、NFTブリッジペイロードを含むワームホールメッセージを消費、検証、および処理できます。

3つの異なるペイロードがあります。

*転送-ロックされたNFTの解放またはラップされたNFTの作成をトリガーします。

NFTブリッジと同じ:

* RegisterChain-外国チェーンのNFTブリッジ契約(送信者アドレス)を登録します。
* UpgradeContract-契約をアップグレードします。

NFTを別のチェーンに転送するには、ユーザーはブリッジ契約の転送方法を
受信者の詳細。契約は、NFTを保管アカウントに保持するか(ネイティブNFTの場合)、または書き込みます
ラップされたNFT。ラップされたNFTは、転送された後は自由に作成できるため、燃やすことができます。後に
契約をロックアップすると、ペイロード転送メッセージがワームホールに送信されます。保護者がメッセージに署名したら、
転送のターゲットチェーンに転記することができます。次に、ターゲットチェーンはネイティブNFTを
ラップされたNFTがネイティブのNFTであるかどうかに応じて、そのNFTを保管またはミントします。プログラムは消費量を追跡します
再生防止のためのメッセージダイジェスト。

VAAをNFTブリッジに投稿する方法は、メッセージ署名自体によって承認されているため、誰でも投稿できます。
メッセージ。

すべてのNFTには一意のメタデータがあるため、転送メッセージにはすべてのメタデータが含まれます。転送(NFTごとの最初のメタデータも含む)
トークンブリッジと比較して、1つのワームホールメッセージを渡すだけで済みます。の最初の転送アクションについて
NFT(アドレス/シンボル/名前)ラップされたアセット(つまり、マスターエディションまたは新しい契約)が作成されます。ラップされたアセットの場合(
コントラクト)がすでに初期化されているか、初期化されたばかりの場合、(新しい)token_idとメタデータURLが登録されます。

### API/データベーススキーマ

提案されたブリッジインターフェイス:

transfer(アドレストークン、uint256 token_id、uint16 receive_chain、bytes32受信者)-転送を開始します

completeTransfer(Message transfer)-転送メッセージを実行します

registerChain(メッセージregisterChain)-RegisterChainガバナンスメッセージを実行します

upgrade(メッセージアップグレード)-UpgradeContractガバナンスメッセージを実行します

---
ペイロード:

移行:

```
PayloadID uint8 = 1
//Address of the NFT. Left-zero-padded if shorter than 32 bytes
NFTAddress [32]uint8
//Chain ID of the NFT
NFTChain uint16
//Symbol of the NFT
Symbol [32]uint8
//Name of the NFT
Name [32]uint8
//ID of the token (big-endian uint256)
TokenID [32]uint8
//URL of the NFT
URLLength u8
URL [n]uint8
//Address of the recipient. Left-zero-padded if shorter than 32 bytes
To [32]uint8
//Chain ID of the recipient
ToChain uint16
```

RegisterChain:

```
PayloadID uint8 = 2
//Chain ID
ChainID uint16
//Emitter address. Left-zero-padded if shorter than 32 bytes
EmitterAddress [32]uint8
```

UpgradeContract:

```
PayloadID uint8 = 3
//Address of the new contract
NewContract [32]uint8
```

## 警告

転送の完了を保証するものではありません。ユーザーが転送を開始し、completeTransferを呼び出さない場合
ターゲットチェーンの場合、転送が完了しない可能性があります。ガーディアンセットの変更が元のセットとの間に発生した場合
署名者保護者セットの有効期限が切れると、転送は無期限に停止します。

NFTブリッジエンドポイントは、他のどのチェーンがすでにアセットをラップしているかを知る方法がないため、
チェーン上のネイティブアセットの場合、ラップされたアセットがまだ設定されていないアセットに対して転送が開始される可能性があります
ターゲットチェーン。ただし、ラップされたアセットが設定されると、転送は実行可能になります(これはいつでも実行できます)
。

現在、ソラナは、イーサリアムと互換性のないu64トークンIDのみをサポートしています。
トークンIDとしてのUUID(uint256のすべてのバイトを使用)。 IDを変換するメカニズムが必要になります。
`[32] u8-> incremental_u64`のマップ(MaxU64エディションを超えることはないだろうと予想されます)またはSolanaのニーズ
NFT契約を変更します。